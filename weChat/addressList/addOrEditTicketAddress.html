<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="format-detection" content="telephone=no" />
    <meta name="format-detection" content="email=no" />
    <!--禁止页面缩放-->
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" id="viewport" name="viewport">
    <title id="title"></title>
    <link rel="stylesheet" href="css/getadress.css">
    <link rel="stylesheet" href="../common/css/common.css">
</head>
<style>
    .bianjidizhi {
        display: block;
    }

    .footer1 {
        display: block;
    }

    .tishiColor::-webkit-input-placeholder {
        color: #E9054D;
        font-family: "微软雅黑";
    }

    .header {
        height: 0.4rem;
        width: 100%;
        text-align: center !important;
        line-height: 0.4rem;
        background: #FFFFFF;
        margin-bottom: 0.1rem;
    }

    .mengcengTishi {
        width: 100%;
        height: 100%;
        background: #333333;
        opacity: 0.9;
        position: fixed;
        left: 0px;
        top: 0px;
        display: none;
    }

    .mengcengTishi p {
        text-align: center;
        margin-top: 60%;
        color: #FFFFFF;
        font-size: 0.2rem;
    }

    .weidenglu_tishi {
        z-index: 30;
        position: fixed;
        left: 10%;
        top: 17%;
        width: 80%;
        background: #FFFFFF;
        border-radius: 0.14rem;
    }

    .weidenglu_tishi_title {
        text-align: center;
    }

    .weidenglu_tishi_bottom {
        border-top: 1px solid rgb(230, 230, 230);
        padding: 0.2rem 0.23rem;
    }

    .i_know {
        width: 80%;
        height: 0.4rem;
        border: 1px solid rgb(255, 221, 16);
        text-align: center;
        line-height: 0.4rem;
        border-radius: 0.2rem;
        margin: 0 auto;
        background: rgb(255, 221, 16);
    }

    .weidenglu_tishi_mobile p {
        text-align: center;
        font-size: 0.24rem !important;
        color: rgb(51, 51, 51);
        padding: 0 0 0.2rem;
    }

    .weidenglu_tishi_title_p2 {
        text-align: center;
        font-size: 0.2rem !important;
        color: rgb(51, 51, 51) !important;
        padding: .14rem !important;
        line-height: 0.21rem;
    }

    li input {
        width: 75%;
    }

    .weidenglu_tishi_bottom {
        border-top: 1px solid #e6e6e6;
        padding: 0.2rem 0.23rem;
        margin-bottom: 0rem;
    }
</style>

<body>
    <div class="wrap">
        <section class="section">
            <div class="bianjidizhi">
                <ul>
                    <!-- <li>收货人：<input type="text" id="receiverName" value="<?php echo $addressInfo['name']?>" placeholder="请输入收货人姓名" /></li>
                    <li>手机：<input type="number" id="receiverMobile" value="<?php echo $addressInfo['mobile']?>" placeholder="请输入11位手机号" /></li>
                    <li>详细地址：<input type="text" id="receiverAddress" value="<?php echo $addressInfo['address']?>" placeholder="请输入详细地址信息" /></li> -->
                    <li>收货人：<input type="text" id="receiverName" value="" placeholder="请输入收货人姓名" /></li>
                    <li>手机：<input type="number" id="receiverMobile" value="" placeholder="请输入11位手机号" /></li>
                    <li>详细地址：<input type="text" id="receiverAddress" value="" placeholder="请输入详细地址信息" /></li>
                </ul>
            </div>
        </section>
        <div class="mengcengTishi"></div>
        <div class="weidenglu_tishi zhifushibai" style="display: none;">
            <div class="weidenglu_tishi_title">
                <p class="weidenglu_tishi_title_p2">修改成功</p>
            </div>
            <div class="weidenglu_tishi_bottom">
                <div class="i_know">我知道了</div>
            </div>
        </div>
        <footer class="footer1" clicktf="true">
            <P>保存</P>
        </footer>
    </div>
    <div class="shezhi_tishi">
        <P>设置成功</P>
    </div>
    <script src="../common/officialJs/jquery-1.8.2.min.js"></script>
    <script src="../common/officialJs/fontSize.js"></script>
    <script src="../common/customJs/URL.js"></script>
    <script src="../common/customJs/AJAX.js"></script>
    <script src="../common/customJs/toastDialog.js"></script>
    <script src="js/common.js"></script>
    <script>
        window.onpageshow = function(event) {
            if (event.persisted) {
                window.location.reload();
            }
        };
        if (!getStorage("userData")) {
            window.location.href = WX_URL + "HXXCServiceWeChat/wechat/wechat_verify";
        } else {
            var userData = getStorage("userData");
        }
        var uid = userData.uid;
        var type = getUrlParam("type");
        var addressId = getUrlParam("aid");
        if (type == "add") {
            $("#title").html("新增收货地址");
        } else if (type == "edit") {
            var addressDetailData = addressDetail({
                "uid": uid,
                "id": addressId
            });
            $("#title").html("编辑收货地址");
            $("#receiverName").val(addressDetailData.name);
            $("#receiverMobile").val(addressDetailData.mobile);
            $("#receiverAddress").val(addressDetailData.address);
            var defaultValue = addressDetailData.defaultValue == 0 ? 'true' : 'false';
        }
        //提交 非空
        $(".footer1").click(function() {
            var receiverName = $("#receiverName").val();
            var receiverMobile = $("#receiverMobile").val();
            var receiverAddress = $("#receiverAddress").val();
            if (receiverName == "" && receiverMobile == "" && receiverAddress == "") {
                tishi("请填写完整的信息！");
                return false;
            } else if (receiverName == '') {
                tishi("请填写收货人姓名！");
                return false;
            } else if (!(/^(1[3-9]{1}\d{9})$/.test(receiverMobile))) {
                tishi("请填写正确的手机号！");
                return false;
            } else if (receiverAddress == '') {
                tishi("请填写收货地址！");
                return false;
            } else {
                var data = {
                    'uid': uid,
                    'name': receiverName,
                    'mobile': receiverMobile,
                    'address': receiverAddress
                }
                if ($(this).attr("clicktf") == "true") {
                    $(this).css("background", "#ccc");
                    $(this).attr("clicktf", "false");
                    if (type == 'edit') {
                        var identity = 'updateUserAddress';
                        data.defaultValue = defaultValue;
                        data.id = addressId;
                        var tishiText = "修改成功";
                        var updateAddressBack = updateAddress(JSON.stringify(data));
                        if (parseInt(updateAddressBack.state) == 0) {
                            // 新增地址成功
                            $(".mengcengTishi").show();
                            $(".weidenglu_tishi_title_p2").text(tishiText);
                            $(".zhifushibai").show();
                        } else if (parseInt(updateAddressBack.state) == 1) {
                            // 新增地址失败
                            tishi(updateAddressBack.message);
                            $(this).css("background", "rgb(255, 221, 16)");
                            $(this).attr("clicktf", "false");
                            return;
                        }
                    } else if (type == 'add') {
                        var identity = 'addUserAddress';
                        var tishiText = "增加成功";
                        var addAddressBack = saveAddress(JSON.stringify(data));
                        if (parseInt(addAddressBack.state) == 0) {
                            // 新增地址成功
                            $(".mengcengTishi").show();
                            $(".weidenglu_tishi_title_p2").text(tishiText);
                            $(".zhifushibai").show();
                        } else if (parseInt(addAddressBack.state) == 1) {
                            // 新增地址失败
                            tishi(addAddressBack.message);
                            $(this).css("background", "rgb(255, 221, 16)");
                            $(this).attr("clicktf", "false");
                            return;
                        }
                    }
                }
            }
        })

        $(".i_know").click(function(event) {
            $(".zhifushibai").hide();
            $(".mengcengTishi").hide();
            self.location = document.referrer;
        });


        // 禁用微信分享
        function onBridgeReady() {
            WeixinJSBridge.call('hideOptionMenu');
        }

        if (typeof WeixinJSBridge == "undefined") {
            if (document.addEventListener) {
                document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
            } else if (document.attachEvent) {
                document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
                document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
            }
        } else {
            onBridgeReady();
        }
    </script>
</body>

</html>
